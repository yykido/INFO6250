{"version":3,"file":"bundle.js","mappings":"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","sources":["webpack://project2/./chat.js","webpack://project2/./src/chat-web.js","webpack://project2/./src/htmlLayout.js","webpack://project2/./src/services.js","webpack://project2/./src/state.js","webpack://project2/webpack/bootstrap","webpack://project2/webpack/runtime/compat get default export","webpack://project2/webpack/runtime/define property getters","webpack://project2/webpack/runtime/hasOwnProperty shorthand","webpack://project2/webpack/runtime/make namespace object","webpack://project2/./src/client.js"],"sourcesContent":["const messages = [];\n\nfunction addMessage( sender, text ) { // Leave this as `sender` - I want to see you solve the name disagreement\n  messages.push(\n    {\n      sender: sender,\n      text: text\n  });\n}\n\nconst chat = {\n  messages,\n  addMessage,\n};\n\nmodule.exports = chat;\n","const chatWeb = {\n    chatPage: function(chat,username) {\n      return `\n            <div id=\"chat-app\">\n              <div class=\"chat-app-left\">\n                ${chatWeb.getUserList(chat)}\n                <div class=\"username-and-logout\">\n                  <div class=\"logout-username\">ID: ${username}</div>\n                  <button class=\"logout-btn\">log out</button>\n                </div>\n              </div>\n              <div class=\"chat-app-right\">\n                ${chatWeb.getMessageList(chat)} \n              </div>\n            </div>\n    `;\n    },\n  \n    getMessageList: function(chat) {\n      return `<ol class=\"messages\">` +\n        // Generate the HTML for the list of messages\n        Object.values(chat.messages).map( user => `\n        <li>\n          <div class=\"message\">\n            <div class=\"sender-info\">\n              <span class=\"username\">${user.sender}</span>\n              </div>\n              <div class=\"massage-info\">\n                <p class=\"message-text\">${user.text}</p>\n              </div>\n          <div>\n        </li>\n        `).join('') +\n        `</ol>`;\n    },\n    getUserList: function(chat) {\n      return `<ul class=\"users\">` +\n      Object.values(chat.users).map( user => `\n        <li>\n          <div class=\"user\">\n            <span >${user}</span>\n          </div>\n        </li>\n      `).join('')+\n      `</ul>`;\n    },\n    getOutgoing: function() {\n      // Generate the HTML for a form to send a message\n      return `\n      <div class=\"outgoing\">\n            <div class=\"flexone\"><input name=\"text\" class=\"to-send\" placeholder=\"Enter message to send\"/></div>\n            <div class=\"flextwo\"><button class=\"send-btn\" type=\"submit\">Send</button></div>\n        </div>\n      `\n    }\n  };\n  module.exports = chatWeb;","const layout = {\n    login: function() {\n        return `\n        <div class=\"login-page\">\n            <div id=\"login-error\"></div>\n            <div class=\"input-box\"><input id=\"username\" type=\"text\" placeholder=\"username\"></div>\n            <div class=\"button-box\"><button class=\"login-btn\">Login</button></div>\n        </div>\n        `\n    },\n}\n\nmodule.exports = layout;","\nconst fetchLogin = function(username) {\n    return fetch('/api/session/', {\n      method: 'POST',\n      headers: {\n        'content-type': 'application/json', // set this header when sending JSON in the body of request\n      },\n      body: JSON.stringify( { username } ),\n    })\n    // fetch() rejects on network error\n    // So we convert that to a formatted error object\n    // so our caller can handle all \"errors\" in a similar way\n    .catch( err => Promise.reject({ error: 'network-error' }) )\n    .then( response => {\n      if(!response.ok) {  // response.ok checks the status code from the service\n        // This service returns JSON on errors,\n        // so we use that as the error object and reject\n        return response.json().then( err => Promise.reject(err) );\n      }\n      return response.json(); // happy status code means resolve with data from service\n    });\n  }\n  \n  const checkIfLogin = function() {\n    return fetch('/api/session/')\n    .catch( () => Promise.reject({ error: 'network-error' }) )\n    .then( response => {\n      if(!response.ok) { \n        return response.json().then( err => Promise.reject(err) );\n      }\n      return response.json(); // happy status code means resolve with data from service\n    });\n  }\n  \n  const Logout = function() {\n    return fetch('/api/session/', {\n      method: 'DELETE',\n      headers: {\n        'content-type': 'application/json', // set this header when sending JSON in the body of request\n      }\n    })\n    .catch( err => Promise.reject({ error: 'network-error' }) )\n    .then( response => {\n      if(!response.ok) { \n        return response.json().then( err => Promise.reject(err) );\n      }\n      return response.json(); \n    });\n  }\n  \n  const displayChat = function() {\n    return fetch('/api/chat/')\n    .catch( () => Promise.reject({ error: 'network-error' }) )\n    .then( response => {\n      if(!response.ok) { \n        return response.json().then( err => Promise.reject(err) );\n      }\n      return response.json(); // happy status code means resolve with data from service\n    });\n  \n  }\n  \n  const sendMessage = function(word) {\n    return fetch('/api/chat/', {\n      method: 'POST',\n      headers: {\n        'content-type': 'application/json', // set this header when sending JSON in the body of request\n      },\n      body: JSON.stringify( { word} ),\n    })\n    .catch( err => Promise.reject({ error: 'network-error' }) )\n    .then( response => {\n      if(!response.ok) { \n        return response.json().then( err => Promise.reject(err) );\n      }\n      return response.json(); \n    });\n  }\n  \n  module.exports = {\n    fetchLogin,\n    checkIfLogin,\n    Logout,\n    displayChat,\n    sendMessage\n  }","const state = {\n    chatPage: false,\n    validUsername: true,\n    validWord: true,\n    username: \"\",\n    messages: \"\",\n    usersLoggedIn: \"\"\n}\n\nmodule.exports = state;\n\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import chatWeb from \"./chat-web\";\nimport chat from \"../chat\";\nimport services from \"./services\";\nimport htmlLayout from \"./htmlLayout\";\nimport state from \"./state\"\n\n// check if loged in\nconst LogedinResult = services.checkIfLogin();\nLogedinResult\n.then(data => {\n    state.username = data.username;\n    const wordPromise = services.displayChat(state.username);\n    state.chatPage = true;\n    wordPromise\n    .then(data => {\n        if(data.message) {\n            state.messages = data.message;\n            state.usersLoggedIn = data.usersLoggedIn;\n        }\n        render();\n    })\n    .catch(error => {\n        console.error(error);// auth-missing go back to login page and reset the status\n        state.chatPage = false;\n        state.username = \"\";\n        state.validUsername = true;\n    });\n})\n.catch(error => {\n    console.error(\"remain in the login page\");\n});\n\n\nlet loginEl = document.querySelector('.login');\nloginEl.addEventListener('click', (e) => {\n    // submit login \n    if(e.target.classList.contains('login-btn')) {\n        console.log(\"login button clicked\");\n        const usernameEl = document.querySelector('#username');\n        state.username = usernameEl.value;\n        const usernamePromise = services.fetchLogin(state.username);// submit the username to check if it is valid\n        usernamePromise\n        .then(data => {\n            console.log(\"submit username successfully!\");\n            state.username = data.username; // can be deleted?\n            const wordPromise = services.displayChat(state.username); \n            wordPromise\n            .then(data => {\n                if(data.message) {\n                    state.messages = data.message;\n                    state.usersLoggedIn = data.usersLoggedIn;\n                }\n                console.log(\"messages\");\n                console.log(state.messages);\n                state.chatPage = true; // show the data page\n                render();\n            })\n            .catch(error => { // auth-missing go back to login page and reset the status\n                console.error(error);\n                state.chatPage = false;\n                state.username = \"\";\n                render();\n            });\n        })\n        .catch(error => { // error invalid username go back to login page, reset the status and show error message\n            console.error(error);\n            state.chatPage = false;\n            state.validUsername = false;\n            state.username = \"\";\n            render();\n        });\n    }\n});\n\nfunction refreshChat() {\n    services.checkIfLogin()\n    .then(data => {\n        state.username = data.username;\n        const wordPromise = services.displayChat(state.username);\n        state.chatPage = true;\n        wordPromise\n        .then(data => {\n            if(data.message) {\n                state.messages = data.message;\n                state.usersLoggedIn = data.usersLoggedIn;\n            }\n            smallRender();\n        })\n        .catch(error => {\n            console.error(error);// auth-missing go back to login page and reset the status\n            state.chatPage = false;\n            state.username = \"\";\n            state.validUsername = true;\n        });\n    })\n    .catch(error => {\n        console.error(\"remain in the login page\");\n    });\n}\n\nfunction pollChat() { \n    refreshChat(); \n    // fetch and use data \n    setTimeout( pollChat, 2000 ); \n}\n\n\nlet chatEl = document.querySelector('.chat');\nlet sendMessageEl = document.querySelector('.sendMessage');\n\nsendMessageEl.addEventListener('click', (e)=> {\n    // send new message from current user\n    if(e.target.classList.contains('send-btn')) {\n        console.log(\"send button clicked\");\n        const responseFromWord = services.sendMessage(document.querySelector('.to-send').value);\n        responseFromWord\n        .then(data => {\n            state.messages = data.message;\n            sendMessageEl.innerHTML = '';\n            const chatWindow = document.querySelector('.chat');\n            chatWindow .scrollTop = chatWindow .scrollHeight;\n            state.validWord = true;\n            render();\n        })\n        .catch(error => {\n            console.error(error);\n            state.validWord = false;\n            render();\n        })\n    }\n});\n\nchatEl.addEventListener('click', (e) => {\n    if(e.target.classList.contains('logout-btn')) {\n        const responseFromDelete = services.Logout();\n        responseFromDelete\n        .then(data => {\n            state.validWord = true;\n            state.chatPage = false;\n            state.validUsername = true;\n            state.username = \"\";\n            state.messages = \"\";\n            state.usersLoggedIn = \"\";\n            render();\n        })\n        .catch(error => {\n            console.error(error);\n        });\n    }\n});\n\nconst render = function() {\n    if(state.chatPage) {\n        console.log(chat.messages);\n        chat.messages = state.messages;\n        chat.users = state.usersLoggedIn;\n        chatEl.innerHTML = chatWeb.chatPage(chat,state.username);\n        sendMessageEl.innerHTML = chatWeb.getOutgoing();\n        loginEl.innerHTML = '';\n    }\n    else {\n        chatEl.innerHTML = '';\n        sendMessageEl.innerHTML = '';\n        loginEl.innerHTML = htmlLayout.login();\n    }\n}\n\nconst smallRender = function() {\n    if(state.chatPage) {\n        chat.messages = state.messages;\n        chat.users = state.usersLoggedIn;\n        chatEl.innerHTML = chatWeb.chatPage(chat,state.username);\n        loginEl.innerHTML = '';\n    }\n    else {\n        chatEl.innerHTML = '';\n        sendMessageEl.innerHTML = '';\n        loginEl.innerHTML = htmlLayout.login();\n    }\n}\n\nrender();\n\npollChat();"],"names":["messages","addMessage","sender","text","push","chat","module","exports","chatWeb","chatPage","username","concat","getUserList","getMessageList","Object","values","map","user","join","users","getOutgoing","layout","login","fetchLogin","fetch","method","headers","body","JSON","stringify","err","Promise","reject","error","then","response","ok","json","checkIfLogin","Logout","displayChat","sendMessage","word","state","validUsername","validWord","usersLoggedIn","services","htmlLayout","LogedinResult","data","wordPromise","message","render","console","loginEl","document","querySelector","addEventListener","e","target","classList","contains","log","usernameEl","value","usernamePromise","refreshChat","smallRender","pollChat","setTimeout","chatEl","sendMessageEl","responseFromWord","innerHTML","chatWindow","scrollTop","scrollHeight","responseFromDelete"],"sourceRoot":""}